AddType text/cache-manifest appcache
AddType application/javascript .js
AddType image/x-icon .ico

AddDefaultCharset utf-8
AddCharset utf-8 .css .txt .js .xml

Options +FollowSymlinks
    
DirectorySlash Off
RewriteEngine on
#RewriteBase /uptobox/

# Rewrite www to no-www domain
RewriteCond %{HTTP_HOST} ^www\.(.+)$ [NC]
RewriteRule ^ http://%1%{REQUEST_URI} [R=301,L]
RewriteRule ^(files)(/?)(.*)$ #/$1$2$3 [R,NC,NE,L]
    
# Rewrite multiple slashes with single slash after domain
RewriteCond %{THE_REQUEST} ^[A-Z]+\s//+(.*)\sHTTP/[0-9.]+$ [OR]
RewriteCond %{THE_REQUEST} ^[A-Z]+\s(.*/)/+\sHTTP/[0-9.]+$
RewriteRule .* http://%{HTTP_HOST}/%1 [R=301,NE,L]

# Rewrite multiple slashes with single slash in URL
RewriteCond %{REQUEST_URI} ^(.*)//(.*)$
RewriteRule . %1/%2 [R=301,NE,L]
    
# Remove slash from URL end
RewriteCond %{REQUEST_URI} ^(.+)/$ [OR]
RewriteRule ^.+/$ %1 [R=301,L]
RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^.+/$ %1 [R=301,L]

# Rewrite backslash with slash
# Works on FF with using AllowEncodedSlashes On in content/httpd.conf
RewriteCond %{REQUEST_URI} ^(.*)\\(.*)$
RewriteRule .* %1/%2 [R=301,NC,L]

# Rewrite space with dash
RewriteCond %{REQUEST_URI} ^([^\ ]*)\ (.*)$
RewriteRule .* %1-%2 [R=301,L]

# Remove question mark and parameters
RewriteCond %{THE_REQUEST} ^[A-Z]+\ /([^?#\ ]*)\?[^\ ]*\ HTTP/ [NC]



 # Rewrite uppercase letter URL to lowercase with content/httpd.conf RewriteMap lc int:tolower
    # Solution without httpd.conf RewriteMap in github.com/laukstein/ajax-seo/wiki/Lowercase-URL
    RewriteCond %{REQUEST_URI} .+
    RewriteRule ^[^A-Z]*[A-Z] ${lc:%0} [R=301,L]
    
RewriteRule ^$ ./php/public/index.php

RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d

<IfModule mod_security.c>
SecFilterEngine Off
SecFilterScanPOST Off
</IfModule>


RewriteRule ^user/files$ ./php/private/user/init/index.php
RewriteRule ^user/files/create$ ./php/private/user/files/create_fold.php
RewriteRule ^user/files/edit$ ./php/private/user/files/edit_folder.php
RewriteRule ^user/files/treeview/(.+)$ ./php/private/user/files/treeview_data.php?id_root=$1

RewriteRule ^user/files/(.+)/(.+)$ ./php/private/user/init/index.php?id_root=$1&name=$2
RewriteRule ^user/path/(.+)/(.+)$ ./php/private/user/init/index_ajax.php?id_root=$1&name=$2
RewriteRule ^user/upload/files$ ./php/private/user/files/upload_files.php


RewriteRule ^user/profile$ ./php/private/user/profile/profile.php
RewriteRule ^user/edit/(.+)$ ./php/private/user/profile/profile_ajax.php?action=$1
RewriteRule ^user/profile/upload_picture$ ./php/private/user/profile/upload_picture_user.php
RewriteRule ^user/tabs/profile$ ./php/private/user/profile/tab_profile.php
RewriteRule ^user/tabs/general$ ./php/private/user/profile/tab_general.php
RewriteRule ^admin$ ./php/private/admin/init/init.php



RewriteRule ^login$ ./php/public/login/login.php
RewriteRule ^activate/(.+)$ ./php/public/login.php?activate_code=$1

RewriteRule ^login/verificate$ ./php/public/login/login_ajax.php

RewriteRule ^clave/reset$ ./php/public/new_password.php

RewriteRule ^init$ ./php/private/user/index.php


RewriteRule ^logout$ ./php/private/logout.php

RewriteRule ^webservices$ ./php/webservices/index.php [QSA,L]

RewriteRule ^webservices/(.*)$ ./php/webservices/index.php [QSA,L]